<!doctypehtml><html lang=en><meta charset=UTF-8><meta content="width=device-width,initial-scale=1"name=viewport><title>NM KILL</title><link href=/favicon.ico rel=icon type=image/png><script src=https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4></script><link href=/css/style.css rel=stylesheet><body class="font-mono select-none bg-white text-black"><audio id=bg-music loop><source src=/assets/audio.mp3 type=audio/mpeg></audio><div class=matrix-rain><div class=matrix-column>01001000 01100101 01101100 01101100 01101111 00100000 01010111 01101111 01110010 01101100 01100100</div><div class=matrix-column>11010100 10101010 01010101 11001100 00110011 10011001 01100110 11110000 00001111</div><div class=matrix-column>10110101 01011010 11010101 00101010 11110000 01010101 10101010 11001100 00110011</div><div class=matrix-column>01110010 10001100 11010011 00101110 11100001 01010111 10101000 11001111 00110000</div><div class=matrix-column>11001010 00110101 10101100 01010011 11110101 00101010 11010101 01100110 10011001</div><div class=matrix-column>01010111 10101000 11001111 00110000 10110101 01011010 11010101 00101010 11110000</div><div class=matrix-column>10001100 11010011 00101110 11100001 01010111 10101000 11001111 00110000 10110101</div><div class=matrix-column>00110101 10101100 01010011 11110101 00101010 11010101 01100110 10011001 01010111</div><div class=matrix-column>11001111 00110000 10110101 01011010 11010101 00101010 11110000 01010101 10101010</div><div class=matrix-column>11010011 00101110 11100001 01010111 10101000 11001111 00110000 10110101 01011010</div></div><div class=war-particles><div class=war-particle></div><div class=war-particle></div><div class=war-particle></div><div class=war-particle></div><div class=war-particle></div><div class=war-particle></div><div class=war-particle></div><div class=war-particle></div><div class=war-particle></div><div class=war-particle></div></div><div class="p-4 min-h-screen scan-effect"id=app><h1 class="uppercase tracking-wider neon-text terminal-text font-bold mb-6 relative text-3xl text-center"data-text="NM KILL">NM KILL<div class=explosion-sparks style=top:10px;right:20px></div><div class=explosion-sparks style=bottom:10px;left:30px></div></h1><div class="flex flex-col gap-6 h-full md:flex-row"><div class=w-full id=left-panel><div class="p-4 hud-element rounded-lg data-stream mb-6"><h3 class="terminal-text font-semibold text-xl">GATEWAY: <span class="opacity-80 neon-text"id=gateway>DETECTING...</span></h3><h3 class="hidden md:block font-semibold terminal-text text-xl">URL: <span class="font-mono px-2 py-1 neon-hover opacity-80"id=current-ip title="Click to copy">DETECTING...</span> <button class="uppercase tracking-wider font-mono cursor-pointer cyber-button ml-2 px-2 py-1 text-xs"id=copy-btn title="Copy URL">COPY</button></h3><div class=mt-2><h3 class="terminal-text font-semibold text-sm">VERSION: <span class="opacity-80 neon-text"id=version>LOADING...</span><button class="uppercase tracking-wider font-mono cursor-pointer cyber-button ml-2 px-2 py-1 text-xs"id=check-update-btn title="Check for Updates">UPDATE</button></h3></div></div><div class="flex flex-col items-start sm:flex-row sm:items-center gap-4 justify-between mb-4"><h2 class="uppercase neon-text terminal-text relative font-bold text-2xl tracking-wide"data-text="IP LIST">IP LIST<div class=spark style=top:5px;right:10px></div></h2><div class="flex flex-col items-start sm:flex-row sm:items-center sm:space-x-4 sm:space-y-0 sm:w-auto space-y-2 w-full"><div class="flex sm:w-auto w-full items-center md:hidden space-x-2"><div class="flex-1 relative"id=search-container><input autocomplete=off class="uppercase tracking-wider font-mono py-2 px-4 bg-white cyber-border duration-200 focus:outline-none hologram placeholder-gray-400 text-black transition-all w-full"id=search-input placeholder="SEARCH DEVICE..."><div class="hidden absolute autocomplete-scroll bg-white border-t-0 cyber-border hologram left-0 max-h-40 overflow-y-auto right-0 shadow-sm top-full z-10"id=autocomplete-list></div></div><button class="uppercase tracking-wider font-mono cursor-pointer cyber-button py-2 px-4 whitespace-nowrap"id=refresh-btn-mobile>SCAN</button></div><div class="hidden md:block relative"id=search-container-desktop><input autocomplete=off class="uppercase tracking-wider font-mono py-2 px-4 bg-white cyber-border duration-200 focus:outline-none hologram placeholder-gray-400 text-black transition-all"id=search-input-desktop placeholder="SEARCH IP..."><div class="hidden absolute autocomplete-scroll bg-white border-t-0 cyber-border hologram left-0 max-h-40 overflow-y-auto right-0 shadow-sm top-full z-10"id=autocomplete-list-desktop></div></div><button class="uppercase tracking-wider font-mono cursor-pointer cyber-button py-2 hidden md:block px-6"id=refresh-btn>REFRESH</button></div></div><div class="py-12 hologram text-center"id=loading><div class="inline-block relative"><div class="rounded-full border-black border-4 h-16 w-16 border-opacity-20"></div><div class="rounded-full border-black absolute animate-spin border-4 border-t-transparent h-16 left-0 top-0 w-16"></div><div class="rounded-full border-black absolute animate-spin border-2 animation-delay-150 border-opacity-30 border-r-transparent h-12 left-2 top-2 w-12"></div><div class="rounded-full border-black absolute animate-spin border-2 animation-delay-300 border-b-transparent h-8 left-4 top-4 w-8"></div><div class="rounded-full border-black absolute animate-spin animation-delay-450 border border-l-transparent h-4 left-6 top-6 w-4"></div></div><div class="space-y-2 mt-6"><div class="flex justify-center space-x-1"><div class="rounded-full animate-pulse bg-black h-2 w-2"></div><div class="rounded-full animate-pulse bg-black h-2 w-2 animation-delay-150"></div><div class="rounded-full animate-pulse bg-black h-2 w-2 animation-delay-300"></div><div class="rounded-full animate-pulse bg-black h-2 w-2 animation-delay-450"></div><div class="rounded-full animate-pulse bg-black h-2 w-2 animation-delay-600"></div></div><p class="uppercase tracking-wider font-mono neon-text opacity-80 terminal-text text-sm">SCANNING NETWORK...</div></div><div class="hidden pb-4"id=devices-container><div class=space-y-4 id=devices-list></div></div></div><div class="hidden md:w-1/2 w-full"id=right-panel><div class="p-4 hud-element rounded-lg"id=sessions-container><h2 class="uppercase neon-text terminal-text relative tracking-wide font-semibold mb-4 md:font-bold md:text-2xl text-xl"data-text="BLOCKED TARGETS">BLOCKED TARGETS<div class=explosion-sparks style=top:5px;right:15px></div></h2><div class=space-y-4 id=sessions-list></div></div></div></div></div><script>const state = {
                devices: [],
                sessions: {},
                gateway: null,
                current: null,
                loading: false,
                selectedIndex: -1
            };

            const elements = {
                gateway: document.getElementById('gateway'),
                currentIp: document.getElementById('current-ip'),
                version: document.getElementById('version'),
                checkUpdateBtn: document.getElementById('check-update-btn'),
                devicesContainer: document.getElementById('devices-container'),
                sessionsContainer: document.getElementById('sessions-container'),
                sessionsList: document.getElementById('sessions-list'),
                loading: document.getElementById('loading'),
                refreshBtn: document.getElementById('refresh-btn'),
                refreshBtnMobile: document.getElementById('refresh-btn-mobile'),
                copyBtn: document.getElementById('copy-btn'),
                searchContainer: document.getElementById('search-container'),
                searchInput: document.getElementById('search-input'),
                autocompleteList: document.getElementById('autocomplete-list'),
                searchContainerDesktop: document.getElementById('search-container-desktop'),
                searchInputDesktop: document.getElementById('search-input-desktop'),
                autocompleteListDesktop: document.getElementById('autocomplete-list-desktop'),
                leftPanel: document.getElementById('left-panel'),
                rightPanel: document.getElementById('right-panel')
            };

            const isActiveSession = (ip) => Object.keys(state.sessions).includes(ip);

            const toggleSearch = () => {
                const isVisible = !elements.searchContainerDesktop.classList.contains('hidden');
                if (isVisible) {
                    elements.searchContainerDesktop.classList.add('hidden');
                    elements.searchInputDesktop.value = '';
                    filterDevices('');
                    hideAutocomplete();
                } else {
                    elements.searchContainerDesktop.classList.remove('hidden');
                    elements.searchInputDesktop.focus();
                }
            };

            const filterDevices = (query) => {
                const deviceElements = document.querySelectorAll('#devices-list > div');
                deviceElements.forEach((element, index) => {
                    const device = state.devices[index];
                    const matches = device.ip.toLowerCase().includes(query.toLowerCase());
                    element.style.display = matches ? 'flex' : 'none';
                });
            };

            const showAutocomplete = (query, isMobile = true) => {
                const autocompleteList = isMobile ? elements.autocompleteList : elements.autocompleteListDesktop;
                const searchInput = isMobile ? elements.searchInput : elements.searchInputDesktop;

                if (!query) {
                    autocompleteList.classList.add('hidden');
                    return;
                }

                const matches = state.devices.filter((device) => device.ip.toLowerCase().includes(query.toLowerCase())).slice(0, 5);

                if (matches.length === 0) {
                    autocompleteList.classList.add('hidden');
                    return;
                }

                if (matches.length === 1) {
                    searchInput.value = matches[0].ip;
                    filterDevices(matches[0].ip);
                    autocompleteList.classList.add('hidden');
                    return;
                }

                autocompleteList.innerHTML = '';
                matches.forEach((device, index) => {
                    const item = document.createElement('div');
                    item.className = `px-4 py-2 neon-hover cursor-pointer font-mono transition-all duration-200 terminal-text ${index === 0 ? 'bg-gray-100' : ''}`;
                    item.textContent = device.ip;
                    item.addEventListener('click', () => {
                        searchInput.value = device.ip;
                        filterDevices(device.ip);
                        autocompleteList.classList.add('hidden');
                    });
                    autocompleteList.appendChild(item);
                });

                autocompleteList.classList.remove('hidden');
            };

            const hideAutocomplete = () => {
                elements.autocompleteList.classList.add('hidden');
                elements.autocompleteListDesktop.classList.add('hidden');
                state.selectedIndex = -1;
            };

            const selectAutocompleteItem = (index, autocompleteList) => {
                const items = autocompleteList.children;
                Array.from(items).forEach((item, i) => {
                    item.classList.toggle('bg-gray-100', i === index);
                    item.classList.toggle('bg-black', false);
                    item.classList.toggle('text-white', false);
                });
                if (items[index]) {
                    items[index].classList.add('bg-black', 'text-white');
                    items[index].classList.remove('bg-gray-100');
                }
                state.selectedIndex = index;
            };

            const applySelectedAutocomplete = (searchInput, autocompleteList) => {
                const items = autocompleteList.children;
                if (state.selectedIndex >= 0 && items[state.selectedIndex]) {
                    const selectedIp = items[state.selectedIndex].textContent;
                    searchInput.value = selectedIp;
                    filterDevices(selectedIp);
                    hideAutocomplete();
                    return true;
                }
                return false;
            };

            const copyToClipboard = async (text) => {
                try {
                    await navigator.clipboard.writeText(text);
                    return true;
                } catch (err) {
                    try {
                        const textArea = document.createElement('textarea');
                        textArea.value = text;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        return true;
                    } catch (fallbackErr) {
                        return false;
                    }
                }
            };

            const showCopyFeedback = (element, isButton = false) => {
                const originalText = element.textContent;

                if (isButton) {
                    element.textContent = 'COPIED!';
                    element.disabled = true;
                    setTimeout(() => {
                        element.textContent = originalText;
                        element.disabled = false;
                    }, 1000);
                } else {
                    const originalOpacity = element.classList.contains('opacity-80') ? 'opacity-80' : 'opacity-100';
                    element.textContent = 'COPIED!';
                    element.classList.remove('opacity-80', 'opacity-100');
                    element.classList.add('opacity-100');
                    setTimeout(() => {
                        element.textContent = originalText;
                        element.classList.remove('opacity-100');
                        element.classList.add(originalOpacity);
                    }, 1000);
                }
            };

            const copyMobileLink = async () => {
                const linkText = elements.currentIp.textContent;
                if (linkText && linkText !== 'UNKNOWN' && linkText !== 'DETECTING...') {
                    const success = await copyToClipboard(linkText);
                    if (success) {
                        showCopyFeedback(elements.copyBtn, true);
                    }
                }
            };

            const showLoading = (show = true) => {
                state.loading = show;
                elements.loading.classList.toggle('hidden', !show);
                elements.devicesContainer.classList.toggle('hidden', show);
                elements.refreshBtn.disabled = show;
                elements.refreshBtnMobile.disabled = show;
                elements.refreshBtn.textContent = show ? 'SCANNING...' : 'SCAN';
                elements.refreshBtnMobile.textContent = show ? 'SCANNING...' : 'SCAN';
            };

            const renderDevices = () => {
                const devicesList = document.getElementById('devices-list');
                devicesList.innerHTML = '';

                state.devices.forEach((device, index) => {
                    const deviceEl = document.createElement('div');
                    deviceEl.className = 'flex justify-between items-center p-4 hud-element rounded-md data-stream';

                    const isActive = isActiveSession(device.ip);
                    const buttonClass = isActive ? 'cyber-button opacity-50 cursor-not-allowed' : 'cyber-button glitch-intense';

                    /* HTML */
                    deviceEl.innerHTML = `
                    <div class="terminal-text relative">
                        <span class="font-semibold neon-text">TARGET:</span> <span class="neon-hover">${device.ip}</span>
                        <div class="spark" style="top: 2px; right: 50px;"></div>
                    </div>
                    <button
                        class="${buttonClass}"
                        data-action="start"
                        data-index="${index}"
                        ${isActive ? 'disabled' : ''}>
                        ${isActive ? 'ACTIVE' : 'KILL'}
                    </button>
                `;

                    devicesList.appendChild(deviceEl);
                });

                setupEventListeners();
            };

            const updateDeviceButtons = () => {
                document.querySelectorAll('[data-action="start"]').forEach((button) => {
                    const index = button.dataset.index;
                    const device = state.devices[index];
                    const isActive = isActiveSession(device.ip);

                    button.disabled = isActive;
                    button.textContent = isActive ? 'ACTIVE' : 'KILL';
                    button.className = isActive ? 'cyber-button opacity-50 cursor-not-allowed' : 'cyber-button glitch-intense';
                });
            };

            const setupEventListeners = () => {
                document.querySelectorAll('[data-action]').forEach((button) => {
                    button.addEventListener('click', (e) => {
                        const action = e.target.dataset.action;
                        const index = e.target.dataset.index;
                        const ip = e.target.dataset.ip;

                        if (action === 'start') {
                            startSpoof(index);
                        } else {
                            stopSpoof(ip);
                        }
                    });
                });
            };

            const updateLayoutVisibility = () => {
                const hasActiveSessions = Object.keys(state.sessions).length > 0;

                if (hasActiveSessions) {
                    elements.rightPanel.classList.remove('hidden');
                    elements.leftPanel.classList.remove('w-full');
                    elements.leftPanel.classList.add('md:w-1/2');
                } else {
                    elements.rightPanel.classList.add('hidden');
                    elements.leftPanel.classList.add('w-full');
                    elements.leftPanel.classList.remove('md:w-1/2');
                }
            };

            const renderSessions = () => {
                const sessionKeys = Object.keys(state.sessions);

                elements.sessionsList.innerHTML = '';

                if (sessionKeys.length === 0) {
                    updateLayoutVisibility();
                    return;
                }

                sessionKeys.forEach((ip) => {
                    const sessionEl = document.createElement('div');
                    sessionEl.className = 'flex justify-between items-center p-4 hud-element rounded-md scan-effect';

                    /* HTML */
                    sessionEl.innerHTML = `
                    <div class="terminal-text relative">
                        <span class="font-semibold neon-text">TARGET:</span> <span class="neon-hover">${ip}</span>
                        <div class="explosion-sparks" style="top: 2px; right: 100px;"></div>
                    </div>
                    <button
                        class="cyber-button"
                        data-stopip="${ip}">
                        ACTIVE
                    </button>
                `;

                    elements.sessionsList.appendChild(sessionEl);
                });

                document.querySelectorAll('[data-stopip]').forEach((button) => {
                    button.addEventListener('click', (e) => {
                        stopSpoof(e.target.dataset.stopip);
                    });
                });

                updateLayoutVisibility();
            };

            const loadData = async () => {
                try {
                    showLoading(true);

                    const [devicesRes, gatewayRes, currentRes, sessionsRes] = await Promise.all([fetch('/api/devices'), fetch('/api/gateway'), fetch('/api/current'), fetch('/api/sessions')]);

                    const devices = await devicesRes.json();
                    const gateway = await gatewayRes.json();
                    const current = await currentRes.json();
                    const sessions = await sessionsRes.json();

                    state.devices = devices.devices;
                    state.gateway = gateway.gateway;
                    state.current = current;
                    state.sessions = sessions;

                    elements.gateway.textContent = gateway.gateway;
                    const currentIpText = current.ip ? `http://${current.ip}` : 'UNKNOWN';
                    elements.currentIp.textContent = currentIpText;
                    renderDevices();
                    renderSessions();
                    updateDeviceButtons();
                } catch (error) {
                    /* HTML */
                    elements.devicesContainer.innerHTML = `
                    <div class="text-center py-8 hologram">
                        <div class="inline-block px-4 py-2 cyber-border bg-white text-black font-mono tracking-wider uppercase glitch-intense neon-text">
                            ERROR: CONNECTION FAILED
                        </div>
                        <div class="mt-2 text-sm opacity-60 terminal-text">PLEASE REFRESH TO RETRY</div>
                    </div>
                `;
                } finally {
                    showLoading(false);
                }
            };

            const loadVersion = async () => {
                try {
                    const response = await fetch('/api/version');
                    const data = await response.json();
                    elements.version.textContent = data.version;
                } catch (error) {
                    elements.version.textContent = 'UNKNOWN';
                }
            };

            const checkForUpdates = async () => {
                try {
                    elements.checkUpdateBtn.textContent = 'CHECKING...';
                    elements.checkUpdateBtn.disabled = true;

                    const response = await fetch('/api/update/check');
                    const data = await response.json();

                    if (data.update_available) {
                        const updateMsg = `Update available: ${data.current_version} â†’ ${data.latest_version}\n\nRight-click system tray icon to update.`;
                        alert(updateMsg)
                    } else {
                        alert('You are using the latest version!');
                    }
                } catch (error) {
                    alert('Error checking for updates: ' + error.message);
                } finally {
                    elements.checkUpdateBtn.textContent = 'UPDATE';
                    elements.checkUpdateBtn.disabled = false;
                }
            };

            const refreshData = async () => {
                try {
                    showLoading(true);
                    const response = await fetch('/api/devices/refresh', { method: 'POST' });
                    const data = await response.json();

                    state.devices = data.devices;
                    state.gateway = data.gateway;
                    state.current = data.current;

                    elements.gateway.textContent = data.gateway;
                    const currentIpText = data.current.ip ? `http://${data.current.ip}` : 'UNKNOWN';
                    elements.currentIp.textContent = currentIpText;
                    renderDevices();

                    const sessionsResponse = await fetch('/api/sessions');
                    state.sessions = await sessionsResponse.json();
                    renderSessions();
                    updateDeviceButtons();
                } catch {
                } finally {
                    showLoading(false);
                }
            };

            const startSpoof = async (deviceId) => {
                try {
                    await fetch(`/api/spoof?target_id=${deviceId}`, {
                        method: 'POST'
                    });

                    const sessionsResponse = await fetch('/api/sessions');
                    state.sessions = await sessionsResponse.json();
                    renderSessions();
                    updateDeviceButtons();
                } catch {}
            };

            const stopSpoof = async (ip) => {
                try {
                    await fetch(`/api/spoof/${ip}`, {
                        method: 'DELETE'
                    });

                    const sessionsResponse = await fetch('/api/sessions');
                    state.sessions = await sessionsResponse.json();
                    renderSessions();
                    updateDeviceButtons();
                } catch {}
            };

            const setupSearchInput = (input, autocompleteList, isMobile) => {
                input.addEventListener('input', (e) => {
                    const query = e.target.value;
                    filterDevices(query);
                    showAutocomplete(query, isMobile);
                });

                input.addEventListener('keydown', (e) => {
                    const isAutocompleteVisible = !autocompleteList.classList.contains('hidden');
                    const itemCount = autocompleteList.children.length;

                    if (e.key === 'Escape') {
                        if (isAutocompleteVisible) {
                            hideAutocomplete();
                        } else if (!isMobile) {
                            toggleSearch();
                        }
                    } else if (e.key === 'ArrowDown' && isAutocompleteVisible) {
                        e.preventDefault();
                        const newIndex = state.selectedIndex < itemCount - 1 ? state.selectedIndex + 1 : 0;
                        selectAutocompleteItem(newIndex, autocompleteList);
                    } else if (e.key === 'ArrowUp' && isAutocompleteVisible) {
                        e.preventDefault();
                        const newIndex = state.selectedIndex > 0 ? state.selectedIndex - 1 : itemCount - 1;
                        selectAutocompleteItem(newIndex, autocompleteList);
                    } else if (e.key === 'Enter' && isAutocompleteVisible) {
                        e.preventDefault();
                        applySelectedAutocomplete(input, autocompleteList);
                    } else if (e.key === 'Tab' && isAutocompleteVisible) {
                        e.preventDefault();
                        applySelectedAutocomplete(input, autocompleteList);
                    }
                });
            };

            let bgMusic = null;
            let audioContext = null;
            let lastMoveTime = 0;
            let bgMusicEnabled = false;

            const initBackgroundMusic = () => {
                bgMusic = document.getElementById('bg-music');
                if (bgMusic) {
                    bgMusic.volume = 0.3;
                    bgMusic.loop = true;
                }
            };

            const playBgMusic = () => {
                if (bgMusic && bgMusic.paused && bgMusicEnabled) {
                    bgMusic.play();
                }
            };

            const playBeep = (frequency = 800, duration = 50, volume = 0.1) => {
                if (!audioContext) return;

                try {
                    if (audioContext.state === 'suspended') {
                        audioContext.resume();
                    }

                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();

                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);

                    oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                    oscillator.type = 'square';

                    gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                    gainNode.gain.linearRampToValueAtTime(volume, audioContext.currentTime + 0.01);
                    gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + duration / 1000);

                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + duration / 1000);
                } catch {}
            };

            const initAudioEvents = () => {
                document.addEventListener('mousemove', () => {
                    const now = Date.now();
                    if (now - lastMoveTime > 100) {
                        playBeep(1200, 15, 0.01);
                        lastMoveTime = now;
                    }
                });

                document.addEventListener('mousedown', () => {
                    playBeep(600, 80, 0.08);
                });

                document.addEventListener('mouseup', () => {
                    playBeep(800, 60, 0.06);
                });

                document.addEventListener('mouseover', (e) => {
                    if (e.target.matches('button, .neon-hover, .cyber-button, input')) {
                        playBeep(1000, 40, 0.04);
                    }
                });

                document.addEventListener('wheel', () => {
                    playBeep(400, 25, 0.03);
                });

                document.addEventListener('keydown', (e) => {
                    const freq = 500 + e.keyCode * 1.5;
                    playBeep(freq, 30, 0.04);
                });

                document.addEventListener('click', () => {
                    playBeep(700, 50, 0.05);
                });

                document.addEventListener('scroll', () => {
                    playBeep(350, 20, 0.02);
                });
            };

            document.addEventListener('DOMContentLoaded', () => {
                initBackgroundMusic();
                initAudioEvents();

                const enableBgMusicOnInteraction = () => {
                    if (bgMusicEnabled) return;

                    if (!audioContext) {
                        audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    }

                    if (audioContext.state === 'suspended') {
                        audioContext.resume().then(() => {
                            bgMusicEnabled = true;
                            playBgMusic();
                        });
                    } else {
                        bgMusicEnabled = true;
                        playBgMusic();
                    }

                    document.removeEventListener('click', enableBgMusicOnInteraction);
                    document.removeEventListener('keydown', enableBgMusicOnInteraction);
                    document.removeEventListener('touchstart', enableBgMusicOnInteraction);
                };

                document.addEventListener('click', enableBgMusicOnInteraction);
                document.addEventListener('keydown', enableBgMusicOnInteraction);
                document.addEventListener('touchstart', enableBgMusicOnInteraction);

                elements.refreshBtn.addEventListener('click', refreshData);
                elements.checkUpdateBtn.addEventListener('click', checkForUpdates);
                loadVersion();
                elements.refreshBtnMobile.addEventListener('click', refreshData);
                elements.copyBtn.addEventListener('click', copyMobileLink);

                setupSearchInput(elements.searchInput, elements.autocompleteList, true);
                setupSearchInput(elements.searchInputDesktop, elements.autocompleteListDesktop, false);

                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey && e.key === 'f') {
                        e.preventDefault();
                        toggleSearch();
                    }
                });

                document.addEventListener('click', (e) => {
                    if (!elements.searchContainer.contains(e.target) && !elements.searchContainerDesktop.contains(e.target)) {
                        hideAutocomplete();
                    }
                });

                loadData();
            });</script>